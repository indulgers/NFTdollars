{"version":3,"file":"index.vue.js","sources":["../../../../packages/components/overlay/bezierCurve/index.vue"],"sourcesContent":["<template></template>\n<script setup lang=\"ts\">\n  import { defineProps, watch, withDefaults, defineEmits, provide } from 'vue'\n  import useBaseMapEffect from '../../../hooks/useBaseMapEffect'\n  import useLifeCycle from '../../../hooks/useLifeCycle'\n  import { bindEvents, Callback, callWhenDifferentValue, type Point, type StrokeStyle } from '../../../utils'\n  export interface BezierCurveProps {\n    /**\n     * 折线的节点坐标数组\n     */\n    path: Point[]\n    /**\n     * 曲线控制点\n     */\n    controlPoints: Point[][]\n    /**\n     * @default #000000\n     * 折线颜色\n     */\n    strokeColor?: string\n    /**\n     * 折线的宽度，以像素为单位\n     */\n    strokeWeight?: number\n    /**\n     * 折线的透明度，取值范围0 - 1\n     */\n    strokeOpacity?: number\n    /**\n     * 折线的样式\n     */\n    strokeStyle?: StrokeStyle\n    /**\n     * @default true\n     * 是否在调用map.clearOverlays清除此覆盖物，默认为true\n     */\n    enableMassClear?: boolean\n    onClick?: Callback\n    onDblclick?: Callback\n    onMousedown?: Callback\n    onMouseup?: Callback\n    onMouseout?: Callback\n    onMouseover?: Callback\n    onRemove?: Callback\n    onLineupdate?: Callback\n  }\n  const props = withDefaults(defineProps<BezierCurveProps>(), {\n    strokeColor: '#000',\n    strokeWeight: 2,\n    strokeOpacity: 1,\n    strokeStyle: 'solid',\n    enableMassClear: true\n  })\n  const vueEmits = defineEmits([\n    'initd',\n    'unload',\n    'click',\n    'dblclick',\n    'mousedown',\n    'mouseup',\n    'mouseout',\n    'mouseover',\n    'remove',\n    'lineupdate'\n  ])\n  const { ready } = useLifeCycle()\n  let bezierCurve: BMapGL.BezierCurve\n  useBaseMapEffect((map: BMapGL.Map) => {\n    const cal = () => {\n      map.removeOverlay(bezierCurve)\n    }\n    const init = () => {\n      if (!props.path || !props.path.length || !props.controlPoints || !props.controlPoints.length) return\n      const { path, controlPoints, strokeColor, strokeWeight, strokeOpacity, strokeStyle, enableMassClear } = props\n      const pathPoints = pathPointsToMapPoints(path)\n      const _controlPoints = controlPoints.map((points) => {\n        return pathPointsToMapPoints(points)\n      })\n      try {\n        bezierCurve = new BMapGL.BezierCurve(pathPoints, _controlPoints, {\n          strokeColor,\n          strokeWeight,\n          strokeOpacity,\n          strokeStyle,\n          enableMassClear\n        })\n      } catch (error) {\n        console.error('Init bezierCurve overlay error, make sure path and controlPoints data is correct!')\n      }\n\n      map.addOverlay(bezierCurve)\n      ready(map, bezierCurve)\n      bindEvents(props, vueEmits, bezierCurve)\n    }\n\n    init()\n    // 监听值变化\n    watch(\n      () => props.path,\n      callWhenDifferentValue((n) => {\n        bezierCurve ? setPath(n) : init()\n      }),\n      {\n        deep: true\n      }\n    )\n    watch(\n      () => props.controlPoints,\n      callWhenDifferentValue((n) => {\n        bezierCurve ? setControlPoints(n) : init()\n      }),\n      {\n        deep: true\n      }\n    )\n    watch(() => props.strokeColor, setStrokeColor)\n    watch(() => props.strokeOpacity, setStrokeOpacity)\n    watch(() => props.strokeWeight, setStrokeWeight)\n    watch(() => props.strokeStyle, setStrokeStyle)\n    watch(() => props.enableMassClear, setMassClear)\n\n    return cal\n  })\n\n  provide('getOverlayInstance', () => bezierCurve)\n\n  function pathPointsToMapPoints(pathPoints: Point[]) {\n    return pathPoints.map(({ lng, lat }) => new BMapGL.Point(lng, lat))\n  }\n\n  function setPath(path: Point[]) {\n    bezierCurve.setPath(pathPointsToMapPoints(path))\n  }\n\n  function setControlPoints(points: Point[][]) {\n    bezierCurve.setControlPoints(points.map((points) => pathPointsToMapPoints(points)))\n  }\n  function setStrokeColor(color: string): void {\n    bezierCurve.setStrokeColor(color)\n  }\n  function setStrokeOpacity(opacity: number): void {\n    bezierCurve.setStrokeOpacity(opacity)\n  }\n  function setStrokeWeight(weight: number): void {\n    bezierCurve.setStrokeWeight(weight)\n  }\n  function setStrokeStyle(style: StrokeStyle): void {\n    bezierCurve.setStrokeStyle(style)\n  }\n  function setMassClear(enableMassClear: boolean): void {\n    enableMassClear ? bezierCurve!.enableMassClear() : bezierCurve!.disableMassClear()\n  }\n</script>\n<script lang=\"ts\">\n  export default {\n    name: 'BBezierCurve'\n  }\n</script>\n"],"names":[],"mappings":"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"}