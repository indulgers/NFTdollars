{"version":3,"file":"index.vue.js","sources":["../../../../packages/components/overlay/label/index.vue"],"sourcesContent":["<template></template>\n<script setup lang=\"ts\">\n  import { defineProps, provide, watch, withDefaults } from 'vue'\n  import useBaseMapEffect from '../../../hooks/useBaseMapEffect'\n  import useLifeCycle from '../../../hooks/useLifeCycle'\n  import { bindEvents, Callback, isDef, callWhenDifferentValue, type Point } from '../../../utils/index'\n  export type LabelStyle = {\n    [k in keyof CSSStyleDeclaration]?: any\n  }\n  export type LabelOffset = {\n    /**\n     * 水平偏移量\n     */\n    x: number\n    /**\n     * 垂直偏移量\n     */\n    y: number\n  }\n  export interface LabelProps {\n    /**\n     * 文本标注信息\n     */\n    content: string\n    position: Point\n    /**\n     * 标注的位置偏移值\n     */\n    offset?: LabelOffset\n    /**\n     * 显示层级\n     */\n    // zIndex: number\n    style?: LabelStyle\n    /**\n     * @default true\n     * 是否可清除\n     * 是否在调用map.clearOverlays清除此覆盖物，默认为true\n     */\n    enableMassClear?: boolean\n    onClick?: Callback\n    onDblclick?: Callback\n    onMousedown?: Callback\n    onMouseup?: Callback\n    onMouseout?: Callback\n    onMouseover?: Callback\n    onRemove?: Callback\n    onRightclick?: Callback\n  }\n  const props = withDefaults(defineProps<LabelProps>(), {\n    offset: () => ({\n      x: 0,\n      y: 0\n    }),\n    enableMassClear: true\n  })\n  const vueEmits = defineEmits([\n    'initd',\n    'unload',\n    'click',\n    'dblclick',\n    'mousedown',\n    'mouseup',\n    'mouseout',\n    'mouseover',\n    'remove',\n    'rightclick'\n  ])\n  const { ready } = useLifeCycle()\n  let label: BMapGL.Label\n  useBaseMapEffect((map: BMapGL.Map) => {\n    const cal = () => {\n      label && map.removeOverlay(label)\n    }\n    const init = () => {\n      const { content, position, offset, enableMassClear, style } = props\n      const options: BMapGL.LabelOptions = {\n        position: new BMapGL.Point(position.lng, position.lat),\n        offset: new BMapGL.Size(offset.x, offset.y),\n        enableMassClear\n      }\n      label = new BMapGL.Label(content, options)\n      // 自定义文本标注样式\n      if (style) {\n        label.setStyle(style)\n      }\n      map.addOverlay(label)\n      // isDef(zIndex) && setZIndex(zIndex)\n      bindEvents(props, vueEmits, label)\n    }\n\n    init()\n    ready(map, label)\n    // 监听值变化\n    watch(() => props.position, callWhenDifferentValue(setPosition), { deep: true })\n    watch(() => props.offset, callWhenDifferentValue(setOffset), { deep: true })\n    watch(() => props.style, callWhenDifferentValue(setStyle), { deep: true })\n    watch(() => props.content, setContent)\n    watch(() => props.enableMassClear, setMassClear)\n\n    return cal\n  })\n\n  provide('getOverlayInstance', () => label)\n\n  // function setZIndex(zIndex: number) {\n  //   console.log('shezhi ')\n  //   label.setZIndex(zIndex)\n  // }\n  function setPosition(position: Point) {\n    label.setPosition(new BMapGL.Point(position.lng, position.lat))\n  }\n  function setStyle(styles?: LabelStyle): void {\n    if (isDef(styles)) label.setStyle(styles!)\n  }\n  function setContent(content: string): void {\n    label.setContent(content)\n  }\n  function setOffset(offset: LabelOffset): void {\n    label.setOffset(new BMapGL.Size(offset.x, offset.y))\n  }\n  function setMassClear(enableMassClear: boolean): void {\n    enableMassClear ? label!.enableMassClear() : label!.disableMassClear()\n  }\n</script>\n<script lang=\"ts\">\n  export default {\n    name: 'BLabel'\n  }\n</script>\n"],"names":[],"mappings":"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"}